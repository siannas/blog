import{h as C,f as A,v as R,c as r,o,a as e,k as v,t as m,a5 as k,F as w,j as S,m as _,y as D,s as F,a3 as N,A as z,p as M,b as B,a4 as I,a7 as j,a8 as V}from"./QrSXNkyt.js";function E(t){let s=t;if(t instanceof String){const[f,a,x]=t.split("-");s=new Date(`${x}-${a}-${f}`)}return`${["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][s.getMonth()]} ${s.getDate()}, ${s.getFullYear()}`}const J={key:0,class:"relative mb-4"},O=["href"],K=["alt","src"],P={class:"relative mt-5"},U={class:"uppercase font-semibold text-xs mb-2.5 text-purple-400"},q=["href"],G={class:"text-2xl font-bold leading-5 duration-200 text-white"},L={class:"mb-4 text-gray-300"},Q=["href"],Y={key:1,class:"flex flex-col md:flex-row gap-6 group"},H={class:"flex-grow"},W={class:"flex items-center mb-2"},X={class:"text-white font-medium mr-3"},Z={class:"uppercase font-semibold text-xs ml-3 text-purple-400"},ee=["href"],te={class:"text-xl font-bold leading-tight duration-200 text-white group-hover:text-purple-300 line-clamp-1"},se={class:"mb-3 text-gray-400 line-clamp-2"},ae={key:0,class:"flex flex-wrap gap-2 mb-3"},le=["onClick"],re={class:"md:w-1/4 flex-shrink-0"},oe=["href"],ne=["alt","src"],$e={__name:"PostItem",props:{position:{type:String,default:""},meta:{type:Object,default:{}},path:{type:String,default:""},avatar:{type:String,default:null},creator:{type:String,default:null},title:{type:String,default:""},description:{type:String,default:""},tags:{type:[Array,String],default:()=>[]}},emits:["tag-clicked"],async setup(t){let s,c;const l=t,f=parseInt(l.path.split("/")[2]),a=E(new Date(parseInt(f)*1e3)),x=l.meta.image?"/content"+l.path+"/images/"+l.meta.image.src:null,{getImage:d}=A(),g=x?([s,c]=C(()=>d(x)),s=await s,c(),s):"https://images.unsplash.com/photo-1516116216624-53e697fedbea?w=400",n=R(()=>Array.isArray(l.tags)?l.tags:typeof l.tags=="string"?l.tags.split(" ").filter(b=>b.trim()!==""):[]);return(b,i)=>t.position!="horizontal"?(o(),r("div",J,[e("a",{href:t.path,class:"block overflow-hidden group shadow-lg rounded-lg"},[e("img",{alt:t.meta.image.alt,src:v(g),class:"aspect-[1.5] object-cover transition-all duration-300 ease-out group-hover:scale-110"},null,8,K)],8,O),e("div",P,[e("p",U,m(v(a)),1),e("a",{href:t.path,class:"block mb-3 hover:underline"},[e("h2",G,m(t.title),1)],8,q),e("p",L,m(t.description),1),e("a",{href:t.path,class:"font-medium underline text-purple-400 hover:text-purple-300"},"Read More",8,Q)])])):(o(),r("div",Y,[e("div",H,[e("div",W,[e("span",X,"by "+m(t.creator||"admin"),1),i[0]||(i[0]=e("span",{class:"text-purple-400"},"•",-1)),e("span",Z,m(v(a)),1)]),e("a",{href:t.path,class:"block mb-2 hover:underline"},[e("h2",te,m(t.title),1)],8,ee),e("p",se,m(t.description),1),v(n).length>0?(o(),r("div",ae,[(o(!0),r(w,null,S(v(n),h=>(o(),r("span",{key:h,class:"px-2 py-1 bg-purple-900/50 text-purple-300 text-xs rounded-full hover:bg-purple-800/50 transition-colors cursor-pointer",onClick:u=>b.$emit("tag-clicked",h)},m(h),9,le))),128))])):k("",!0)]),e("div",re,[e("a",{href:t.path,class:"block overflow-hidden group rounded-lg"},[e("img",{alt:t.meta.image?.alt||"Post Image",src:v(g),class:"aspect-[1.5] object-cover transition-all duration-300 ease-out group-hover:scale-110"},null,8,ne)],8,oe)])]))}};function ce(){const t=_(""),s=_([]),c=_([]),l=_(!1),f=_(null),a=async(i,h=[])=>{if((!i||i.trim()==="")&&h.length===0)return c.value=[],[];l.value=!0,f.value=null;try{const{$search:u}=D();let p=[];return i&&i.trim()!==""?p=await u.performSearch(i):p=u.documents||[],h&&h.length>0&&(p=p.filter(y=>{if(y.tags){const $=y.tags;return h.some(T=>$.includes(T))}return!1})),c.value=p,p}catch(u){return f.value=u,c.value=[],console.error("Search error:",u),[]}finally{l.value=!1}};return{searchTerm:t,selectedTags:s,searchResults:c,isSearching:l,error:f,initialize:async()=>{},performSearch:a,filterByTag:i=>{s.value.includes(i)||s.value.push(i),a(t.value,s.value)},removeTagFilter:i=>{s.value=s.value.filter(h=>h!==i),a(t.value,s.value)},clearTagFilters:()=>{s.value=[],a(t.value,[])},getAllTags:()=>{const i=new Set;return c.value.forEach(h=>{h.tags&&h.tags.forEach(p=>{p.trim()!==""&&i.add(p.trim())})}),Array.from(i)}}}const ie={key:0,class:"mb-6"},ue={class:"flex flex-wrap gap-2"},de=["onClick"],pe={key:0,class:"mt-3 flex flex-wrap gap-2"},ge={class:"px-2 py-1 bg-purple-800 text-purple-200 text-xs rounded-l"},he=["onClick"],me={__name:"TagsFilter",props:{availableTags:{type:Array,default:()=>[]},selectedTags:{type:Array,default:()=>[]}},emits:["update:selectedTags","tag-selected","tag-removed","tags-cleared"],setup(t,{emit:s}){const c=t,l=s,f=d=>{const g=[...c.selectedTags],n=g.indexOf(d);n>-1?(g.splice(n,1),l("tag-removed",d)):(g.push(d),l("tag-selected",d)),l("update:selectedTags",g)},a=d=>{const g=c.selectedTags.filter(n=>n!==d);l("update:selectedTags",g),l("tag-removed",d)},x=()=>{l("update:selectedTags",[]),l("tags-cleared")};return(d,g)=>t.availableTags.length>0?(o(),r("div",ie,[e("div",ue,[(o(!0),r(w,null,S(t.availableTags,n=>(o(),r("button",{key:n,onClick:b=>f(n),class:F(["px-3 py-1 text-sm rounded-full transition-colors",t.selectedTags.includes(n)?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},m(n),11,de))),128))]),t.selectedTags.length>0?(o(),r("div",pe,[g[0]||(g[0]=e("span",{class:"text-sm text-gray-400"},"Selected tags:",-1)),(o(!0),r(w,null,S(t.selectedTags,n=>(o(),r("div",{key:n,class:"flex items-center"},[e("span",ge,m(n),1),e("button",{onClick:b=>a(n),class:"px-1 py-1 bg-purple-900 text-purple-200 text-xs rounded-r hover:bg-purple-700 transition-colors"}," × ",8,he)]))),128)),e("button",{onClick:x,class:"text-xs text-purple-400 hover:text-purple-300 underline"}," Clear all ")])):k("",!0)])):k("",!0)}},ve={class:"mb-8"},fe={class:"relative"},xe={key:0,class:"mt-4 bg-gray-800/50 backdrop-blur-sm rounded-xl border border-gray-700 max-h-80 overflow-y-auto"},ye=["onClick"],be={class:"font-semibold text-white text-sm"},_e={class:"text-xs text-gray-400 mt-1"},Te={key:0,class:"mt-2 flex flex-wrap gap-1"},ke={key:1,class:"mt-4 text-center py-2 text-gray-400 text-sm"},we={key:2,class:"mt-4 text-center py-2"},Ce={__name:"NotesSearch",setup(t){const s=_(""),c=_([]),l=_([]),f=N(),a=ce();let x=null;const d=()=>{x&&clearTimeout(x),x=setTimeout(()=>{a.performSearch(s.value,c.value)},300)},g=u=>{f.push(u.path)},n=u=>{c.value=u,a.performSearch(s.value,u)},b=u=>{a.performSearch(s.value,c.value)},i=u=>{a.performSearch(s.value,c.value)},h=()=>{a.performSearch(s.value,[])};return z(s,u=>{u?d():a.searchResults.value=[]}),M(async()=>{await a.initialize(),l.value=a.getAllTags()}),(u,p)=>(o(),r("div",ve,[e("div",fe,[p[1]||(p[1]=e("div",{class:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none"},[e("svg",{class:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1)),I(e("input",{type:"text","onUpdate:modelValue":p[0]||(p[0]=y=>s.value=y),onInput:d,onKeyup:V(d,["enter"]),class:"block w-full p-3 pl-10 text-sm rounded-lg bg-gray-800 border border-gray-700 focus:ring-purple-500 focus:border-purple-500 text-white",placeholder:"Search other notes...",required:""},null,544),[[j,s.value]]),e("button",{onClick:d,class:"text-white absolute right-2.5 bottom-2.5 bg-purple-700 hover:bg-purple-800 focus:ring-4 focus:outline-none focus:ring-purple-300 font-medium rounded-lg text-sm px-4 py-1"}," Search ")]),B(me,{"available-tags":l.value,"selected-tags":c.value,"onUpdate:selectedTags":n,onTagSelected:b,onTagRemoved:i,onTagsCleared:h,class:"mt-4"},null,8,["available-tags","selected-tags"]),v(a).searchResults.value&&v(a).searchResults.value.length>0?(o(),r("div",xe,[(o(!0),r(w,null,S(v(a).searchResults.value,(y,$)=>(o(),r("div",{key:$,onClick:T=>g(y),class:"p-3 border-b border-gray-700 last:border-b-0 hover:bg-gray-700/50 cursor-pointer transition-colors"},[e("h3",be,m(y.title),1),e("p",_e,m(y.description),1),y.tags?(o(),r("div",Te,[(o(!0),r(w,null,S(y.tags.filter(T=>T.trim()!==""),T=>(o(),r("span",{key:T,class:"px-2 py-0.5 bg-purple-900/50 text-purple-300 text-xs rounded"},m(T),1))),128))])):k("",!0)],8,ye))),128))])):k("",!0),s.value&&v(a).searchResults.value&&v(a).searchResults.value.length===0&&!v(a).isSearching.value?(o(),r("div",ke," No notes found. ")):k("",!0),v(a).isSearching.value?(o(),r("div",we,[...p[2]||(p[2]=[e("div",{class:"inline-block animate-spin rounded-full h-5 w-5 border-b-2 border-purple-500"},null,-1)])])):k("",!0)]))}};export{Ce as _,$e as a,E as b,ce as u};
